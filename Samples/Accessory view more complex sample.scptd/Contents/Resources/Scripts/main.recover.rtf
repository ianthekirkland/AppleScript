{\rtf1\ansi\ansicpg1252\cocoartf1671\cocoasubrtf200
{\fonttbl\f0\fnil\fcharset0 Verdana-Bold;\f1\fnil\fcharset0 Verdana;\f2\fnil\fcharset0 Verdana-Italic;
}
{\colortbl;\red255\green255\blue255;\red108\green5\blue211;\red0\green0\blue255;\red64\green128\blue0;
\red77\green78\blue78;\red251\green0\blue7;\red0\green22\blue176;}
{\*\expandedcolortbl;;\csgenericrgb\c42300\c1800\c82800;\csgenericrgb\c0\c0\c99819;\csgenericrgb\c25000\c50000\c0;
\csgenericrgb\c30000\c30500\c30500;\cssrgb\c100000\c0\c0;\csgenericrgb\c0\c8700\c69000;}
\deftab480
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\b\fs24 \cf0 use
\f1\b0 \cf0  \cf2 AppleScript\cf0  \cf3 version\cf0  \cf0 "2.4"\cf0 \
\pard\pardeftab480\slleading40\pardirnatural\partightenfactor0

\f0\b \cf0 use
\f1\b0 \cf0  
\f2\i \cf3 framework
\f1\i0 \cf0  \cf0 "Foundation"\cf0 \

\f0\b \cf0 use
\f1\b0 \cf0  
\f2\i \cf3 framework
\f1\i0 \cf0  \cf0 "AppKit"\cf0 \

\f0\b \cf0 use
\f1\b0 \cf0  
\f2\i \cf3 script
\f1\i0 \cf0  \cf0 "Myriad Tables Lib"\cf0  \cf3 version\cf0  \cf0 "1.0.9"\cf0 \

\f0\b \cf0 use
\f1\b0 \cf0  
\f2\i \cf3 scripting additions
\f1\i0 \cf0 \
\

\f0\b \cf0 property
\f1\b0 \cf0  \cf4 theCheckbox\cf0  : 
\f2\i \cf3 missing value
\f1\i0 \cf0 \

\f0\b \cf0 property
\f1\b0 \cf0  \cf4 thePopup\cf0  : 
\f2\i \cf3 missing value
\f1\i0 \cf0 \

\f0\b \cf0 property
\f1\b0 \cf0  \cf4 theAccessoryView\cf0  : 
\f2\i \cf3 missing value
\f1\i0 \cf0 \
\

\f0\b \cf0 set
\f1\b0 \cf0  \cf4 popupList\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \{\cf0 "Fred"\cf0 , \cf0 "Frieda"\cf0 , \cf0 "George"\cf0 , \cf0 "Georgina"\cf0 \}\

\f2\i \cf5 -- Manipulation of views should be done on the main thread
\f1\i0 \cf0 \

\f0\b \cf0 if
\f1\b0 \cf0  \cf2 current application's\cf0  \cf4 NSThread's\cf0  \cf6 isMainThread\cf0 () 
\f0\b \cf0 as
\f1\b0 \cf0  
\f2\i \cf3 boolean
\f1\i0 \cf0  
\f0\b \cf0 then
\f1\b0 \cf0 \
	
\f0\b \cf0 my
\f1\b0 \cf0  \cf6 createCheckBoxMainThread\cf0 :\{\cf0 "Check me"\cf0 , \cf0 "checkboxClicked:"\cf0 \}\
	
\f0\b \cf0 my
\f1\b0 \cf0  \cf6 createPopupMainThread\cf0 :\{\cf4 popupList\cf0 , \cf0 "Georgina"\cf0 \}\
	
\f0\b \cf0 my
\f1\b0 \cf0  \cf6 buildAccessoryViewMainThread\cf0 :\{\cf4 theCheckbox\cf0 , \cf4 thePopup\cf0 \}\

\f0\b \cf0 else
\f1\b0 \cf0 \
	
\f0\b \cf0 my
\f1\b0 \cf0  \cf6 performSelectorOnMainThread\cf0 :\cf0 "createCheckBoxMainThread:"\cf0  \cf6 withObject\cf0 :\{\cf0 "Check me"\cf0 , \cf0 "checkboxClicked:"\cf0 \} \cf6 waitUntilDone\cf0 :\cf2 true\cf0 \
	
\f0\b \cf0 my
\f1\b0 \cf0  \cf6 performSelectorOnMainThread\cf0 :\cf0 "createPopupMainThread:"\cf0  \cf6 withObject\cf0 :\{\cf4 popupList\cf0 , \cf0 "Georgina"\cf0 \} \cf6 waitUntilDone\cf0 :\cf2 true\cf0 \
	
\f0\b \cf0 my
\f1\b0 \cf0  \cf6 performSelectorOnMainThread\cf0 :\cf0 "buildAccessoryViewMainThread:"\cf0  \cf6 withObject\cf0 :\{\cf4 theCheckbox\cf0 , \cf4 thePopup\cf0 \} \cf6 waitUntilDone\cf0 :\cf2 true\cf0 \

\f0\b \cf0 end
\f1\b0 \cf0  
\f0\b \cf0 if
\f1\b0 \cf0 \
\

\f2\i \cf5 -- make a table and add the accessory view
\f1\i0 \cf0 \

\f0\b \cf0 set
\f1\b0 \cf0  \cf4 theTable\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  
\f0\b \cf7 make new table with data
\f1\b0 \cf0  \{\cf0 "One"\cf0 , \cf0 "Two"\cf0 , \cf0 "Three"\cf0 , \cf0 "Four"\cf0 , \cf0 "Five"\cf0 \}\

\f0\b \cf7 modify table
\f1\b0 \cf0  \cf4 theTable\cf0  \cf7 accessory view\cf0  \cf4 theAccessoryView\cf0 \

\f0\b \cf0 set
\f1\b0 \cf0  \cf4 theAccessoryView\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  
\f2\i \cf3 missing value
\f1\i0 \cf0  
\f2\i \cf5 -- to avoid error messages when saving
\f1\i0 \cf0 \

\f0\b \cf7 display table
\f1\b0 \cf0  \cf4 theTable\cf0 \

\f2\i \cf5 -- get the state of the checkbox
\f1\i0 \cf0 \

\f0\b \cf0 set
\f1\b0 \cf0  \cf4 theState\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \cf4 theCheckbox's\cf0  \cf6 state\cf0 () 
\f0\b \cf0 as
\f1\b0 \cf0  
\f2\i \cf3 boolean
\f1\i0 \cf0 \

\f0\b \cf0 set
\f1\b0 \cf0  \cf4 theCheckbox\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  
\f2\i \cf3 missing value
\f1\i0 \cf0  
\f2\i \cf5 -- to avoid error messages when saving
\f1\i0 \cf0 \

\f0\b \cf0 set
\f1\b0 \cf0  \cf4 theValue\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \cf4 thePopup's\cf0  \cf6 title\cf0 () 
\f0\b \cf0 as
\f1\b0 \cf0  
\f2\i \cf3 text
\f1\i0 \cf0 \

\f0\b \cf0 set
\f1\b0 \cf0  \cf4 thePopup\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  
\f2\i \cf3 missing value
\f1\i0 \cf0 \

\f0\b \cf7 display dialog
\f1\b0 \cf0  \cf4 theValue\cf0 \
\

\f0\b \cf0 on
\f1\b0 \cf0  \cf6 createCheckBoxMainThread\cf0 :\cf4 theArg\cf0 \
	
\f0\b \cf0 set
\f1\b0 \cf0  \{\cf4 theTitle\cf0 , \cf4 theAction\cf0 \} 
\f0\b \cf0 to
\f1\b0 \cf0  \cf4 theArg\cf0  
\f0\b \cf0 as
\f1\b0 \cf0  
\f2\i \cf3 list
\f1\i0 \cf0 \
	
\f2\i \cf5 -- build a checkbox
\f1\i0 \cf0 \
	
\f0\b \cf0 set
\f1\b0 \cf0  
\f0\b \cf0 my
\f1\b0 \cf0  \cf4 theCheckbox\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \cf2 current application's\cf0  \cf4 NSButton's\cf0  \cf6 alloc\cf0 ()'s \cf6 initWithFrame\cf0 :\{\{\cf0 10\cf0 , \cf0 10\cf0 \}, \{\cf0 150\cf0 , \cf0 18\cf0 \}\}\
	
\f0\b \cf0 tell
\f1\b0 \cf0  \cf4 theCheckbox\cf0 \
		
\f0\b \cf0 its
\f1\b0 \cf0  \cf6 setButtonType\cf0 :(\cf2 current application's\cf0  \cf4 NSSwitchButton\cf0 )\
		
\f0\b \cf0 its
\f1\b0 \cf0  \cf6 setTitle\cf0 :\cf4 theTitle\cf0 \
		
\f0\b \cf0 its
\f1\b0 \cf0  \cf6 setTarget\cf0 :
\f0\b \cf0 me
\f1\b0 \cf0 \
		
\f0\b \cf0 its
\f1\b0 \cf0  \cf6 setAction\cf0 :\cf4 theAction\cf0  
\f2\i \cf5 -- a handler in this script
\f1\i0 \cf0 \
	
\f0\b \cf0 end
\f1\b0 \cf0  
\f0\b \cf0 tell
\f1\b0 \cf0 \

\f0\b \cf0 end
\f1\b0 \cf0  \cf6 createCheckBoxMainThread\cf0 :\
\

\f0\b \cf0 on
\f1\b0 \cf0  \cf6 createPopupMainThread\cf0 :\cf4 theArg\cf0 \
	
\f0\b \cf0 set
\f1\b0 \cf0  \{\cf4 entryList\cf0 , \cf4 defaultValue\cf0 \} 
\f0\b \cf0 to
\f1\b0 \cf0  \cf4 theArg\cf0  
\f0\b \cf0 as
\f1\b0 \cf0  
\f2\i \cf3 list
\f1\i0 \cf0 \
	
\f0\b \cf0 set
\f1\b0 \cf0  
\f0\b \cf0 my
\f1\b0 \cf0  \cf4 thePopup\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \cf2 current application's\cf0  \cf4 NSPopUpButton's\cf0  \cf6 alloc\cf0 ()'s \cf6 initWithFrame\cf0 :\{\{\cf0 10\cf0 , \cf0 35\cf0 \}, \{\cf0 150\cf0 , \cf0 26\cf0 \}\} \cf6 pullsDown\cf0 :\cf2 false\cf0 \
	\cf4 thePopup's\cf0  \cf6 addItemsWithTitles\cf0 :\cf4 entryList\cf0 \
	\cf4 thePopup's\cf0  \cf6 selectItemWithTitle\cf0 :\cf4 defaultValue\cf0 \

\f0\b \cf0 end
\f1\b0 \cf0  \cf6 createPopupMainThread\cf0 :\
\

\f0\b \cf0 on
\f1\b0 \cf0  \cf6 buildAccessoryViewMainThread\cf0 :\cf4 theControls\cf0 \
	
\f0\b \cf0 set
\f1\b0 \cf0  
\f0\b \cf0 my
\f1\b0 \cf0  \cf4 theAccessoryView\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \cf2 current application's\cf0  \cf4 NSView's\cf0  \cf6 alloc\cf0 ()'s \cf6 initWithFrame\cf0 :\{\{\cf0 0\cf0 , \cf0 0\cf0 \}, \{\cf0 160\cf0 , \cf0 60\cf0 \}\}\
	
\f0\b \cf0 repeat
\f1\b0 \cf0  
\f0\b \cf0 with
\f1\b0 \cf0  \cf4 aControl\cf0  
\f0\b \cf0 in
\f1\b0 \cf0  \cf4 theControls\cf0 \
		(\cf4 theAccessoryView's\cf0  \cf6 addSubview\cf0 :\cf4 aControl\cf0 )\
	
\f0\b \cf0 end
\f1\b0 \cf0  
\f0\b \cf0 repeat
\f1\b0 \cf0 \

\f0\b \cf0 end
\f1\b0 \cf0  \cf6 buildAccessoryViewMainThread\cf0 :\
\

\f2\i \cf5 -- this is called when the checkbox is clicked
\f1\i0 \cf0 \

\f0\b \cf0 on
\f1\b0 \cf0  \cf6 checkboxClicked\cf0 :\cf4 sender\cf0 \
	
\f2\i \cf5 -- make an alert and show it as a sheet over the table window
\f1\i0 \cf0 \
	
\f0\b \cf0 set
\f1\b0 \cf0  \cf4 theWindow\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \cf4 sender's\cf0  \cf6 |window|\cf0 ()\
	
\f0\b \cf0 set
\f1\b0 \cf0  \cf4 theAlert\cf0  
\f0\b \cf0 to
\f1\b0 \cf0  \cf2 current application's\cf0  \cf4 NSAlert's\cf0  \cf6 alloc\cf0 ()'s \cf6 init\cf0 ()\
	\cf4 theAlert's\cf0  \cf6 setMessageText\cf0 :\cf0 "You clicked the checkbox"\cf0 \
	\cf4 theAlert's\cf0  \cf6 setInformativeText\cf0 :\cf0 "Now close this sheet"\cf0 \
	\cf4 theAlert's\cf0  \cf6 beginSheetModalForWindow\cf0 :\cf4 theWindow\cf0  \cf6 completionHandler\cf0 :(
\f2\i \cf3 missing value
\f1\i0 \cf0 )\

\f0\b \cf0 end
\f1\b0 \cf0  \cf6 checkboxClicked\cf0 :\
\
}